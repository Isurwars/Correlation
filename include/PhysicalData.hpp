// Correlation - Liquid and Amorphous Solid Analysis Tool
// Copyright © 2013-2026 Isaías Rodríguez (isurwars@gmail.com)
// SPDX-License-Identifier: MIT
// Full license: https://github.com/Isurwars/Correlation/blob/main/LICENSE

#pragma once

#include <stdexcept>
#include <string>
#include <unordered_map>
#include <vector>

/**
 * @namespace constants
 * @brief Defines universal mathematical and physical constants.
 */
namespace constants {
// Use the standard library's high-precision pi from C++20
constexpr double pi =
    3.1415926535897932384626433832795028841971693993751058209749445923078164062;
constexpr double rad2deg = 180.0 / pi;    // RADIANS -> DEGREES
constexpr double deg2rad = pi / 180.0;    // DEGREES -> RADIANS
constexpr double THz_to_cmInv = 33.35641; // THz -> cm^-1
constexpr double THz_to_meV = 4.135667;   // THz -> meV
} // namespace constants

/**
 * @class CovalentRadii
 * @brief Provides a static database of covalent radii for chemical elements.
 * Data from Pyykko, P. et al., DOI: 10.1002/chem.200800987 and Cordero, B. et
 * al., DOI: 10.1039/b801115j
 */
class CovalentRadii {
public:
  static double get(const std::string &symbol) {
    static const std::unordered_map<std::string, double> radii = {
        {"H", 0.32},  {"He", 0.46}, {"Li", 1.33}, {"Be", 1.02}, {"B", 0.85},
        {"C", 0.75},  {"N", 0.71},  {"O", 0.63},  {"F", 0.64},  {"Ne", 0.67},
        {"Na", 1.55}, {"Mg", 1.39}, {"Al", 1.26}, {"Si", 1.16}, {"P", 1.11},
        {"S", 1.03},  {"Cl", 0.99}, {"Ar", 0.96}, {"K", 1.96},  {"Ca", 1.71},
        {"Sc", 1.48}, {"Ti", 1.36}, {"V", 1.34},  {"Cr", 1.22}, {"Mn", 1.19},
        {"Fe", 1.16}, {"Co", 1.11}, {"Ni", 1.10}, {"Cu", 1.12}, {"Zn", 1.18},
        {"Ga", 1.24}, {"Ge", 1.21}, {"As", 1.21}, {"Se", 1.16}, {"Br", 1.14},
        {"Kr", 1.17}, {"Rb", 2.10}, {"Sr", 1.85}, {"Y", 1.63},  {"Zr", 1.54},
        {"Nb", 1.47}, {"Mo", 1.38}, {"Tc", 1.28}, {"Ru", 1.25}, {"Rh", 1.25},
        {"Pd", 1.20}, {"Ag", 1.28}, {"Cd", 1.36}, {"In", 1.42}, {"Sn", 1.40},
        {"Sb", 1.40}, {"Te", 1.36}, {"I", 1.33},  {"Xe", 1.31}, {"Cs", 2.32},
        {"Ba", 1.96}, {"La", 1.80}, {"Ce", 1.63}, {"Pr", 1.76}, {"Nd", 1.74},
        {"Pm", 1.73}, {"Sm", 1.72}, {"Eu", 1.68}, {"Gd", 1.69}, {"Tb", 1.68},
        {"Dy", 1.67}, {"Ho", 1.66}, {"Er", 1.65}, {"Tm", 1.64}, {"Yb", 1.70},
        {"Lu", 1.62}, {"Hf", 1.52}, {"Ta", 1.46}, {"W", 1.37},  {"Re", 1.31},
        {"Os", 1.29}, {"Ir", 1.22}, {"Pt", 1.23}, {"Au", 1.24}, {"Hg", 1.33},
        {"Tl", 1.44}, {"Pb", 1.44}, {"Bi", 1.51}, {"Po", 1.45}, {"At", 1.47},
        {"Rn", 1.42}, {"Fr", 2.23}, {"Ra", 2.01}, {"Ac", 1.86}, {"Th", 1.75},
        {"Pa", 1.69}, {"U", 1.70},  {"Np", 1.71}, {"Pu", 1.72}, {"Am", 1.66},
        {"Cm", 1.66}, {"Bk", 1.68}, {"Cf", 1.68}, {"Es", 1.65}, {"Fm", 1.67},
        {"Md", 1.73}, {"No", 1.76}, {"Lr", 1.61}, {"Rf", 1.57}, {"Db", 1.49},
        {"Sg", 1.43}, {"Bh", 1.41}, {"Hs", 1.34}, {"Mt", 1.29}, {"Ds", 1.28},
        {"Rg", 1.21}, {"Cn", 1.22}, {"Nh", 1.36}, {"Fl", 1.43}, {"Mc", 1.62},
        {"Lv", 1.75}, {"Ts", 1.65}, {"Og", 1.57}};
    auto it = radii.find(symbol);
    if (it != radii.end()) {
      return it->second;
    }
    throw std::out_of_range("Covalent radius not found for element: " + symbol);
  }

private:
  CovalentRadii() = default;
};

/**
 * @class AtomicFormFactors
 * @brief Provides a static database of atomic form factor parameters.
 * Data from International Tables for Crystallography:
 * http://it.iucr.org/CB/ch6o1v0001/
 */
class AtomicFormFactors {
public:
  static const std::vector<double> &get(const std::string &symbol) {
    static const std::unordered_map<std::string, std::vector<double>> factors =
        {
            {"Al",
             {6.4202, 3.0387, 1.9002, 0.7426, 1.5936, 31.5472, 1.9646, 85.0886,
              1.1151}},
            {"Ar",
             {7.4845, 0.9072, 6.7723, 14.8407, 0.6539, 43.8983, 1.6442, 33.3929,
              1.4445}},
            {"As",
             {16.6723, 2.6345, 6.0701, 0.2647, 3.4313, 12.9479, 4.2779, 47.7972,
              2.531}},
            {"B",
             {2.0545, 23.2185, 1.3326, 1.021, 1.0979, 60.3498, 0.7068, 0.1403,
              -0.1932}},
            {"Be",
             {1.5919, 43.6427, 1.1278, 1.8623, 0.5391, 103.483, 0.7029, 0.542,
              0.0385}},
            {"Br",
             {17.1789, 2.1723, 5.2358, 16.5796, 5.6377, 0.2609, 3.9851, 41.4328,
              2.9557}},
            {"C",
             {2.31, 20.8439, 1.02, 10.2075, 1.5886, 0.5687, 0.865, 51.6512,
              0.2156}},
            {"Ca",
             {8.6266, 10.4421, 7.3873, 0.6599, 1.5899, 85.7484, 1.0211, 178.437,
              1.3751}},
            {"Cl",
             {11.4604, 0.0104, 7.1964, 1.1662, 6.2556, 18.5194, 1.6455, 47.7784,
              -9.5574}},
            {"Co",
             {12.2841, 4.2791, 7.3409, 0.2784, 4.0034, 13.5359, 2.3488, 71.1692,
              1.0118}},
            {"Cr",
             {10.6406, 6.1038, 7.3537, 0.392, 3.324, 20.2626, 1.4922, 98.7399,
              1.1832}},
            {"Cu",
             {13.338, 3.5828, 7.1676, 0.247, 5.6158, 11.3966, 1.6735, 64.8126,
              1.191}},
            {"F",
             {3.5392, 10.2825, 2.6412, 4.2944, 1.517, 0.2615, 1.0243, 26.1476,
              0.2776}},
            {"Fe",
             {11.7695, 4.7611, 7.3573, 0.3072, 3.5222, 15.3535, 2.3045, 76.8805,
              1.0369}},
            {"Ga",
             {15.2354, 3.0669, 6.7006, 0.2412, 4.3591, 10.7805, 2.9623, 61.4135,
              1.7189}},
            {"Ge",
             {16.0816, 2.8509, 6.3747, 0.2516, 3.7068, 11.4468, 3.683, 54.7625,
              2.1313}},
            {"H",
             {0.489918, 20.6593, 0.262003, 7.74039, 0.196767, 49.5519, 0.049879,
              2.20159, 0.001305}},
            {"He",
             {0.8734, 9.1037, 0.6309, 3.3568, 0.3112, 22.9276, 0.178, 0.9821,
              0.0064}},
            {"K",
             {8.2186, 12.7949, 7.4398, 0.7748, 1.0519, 213.187, 0.8659, 41.6841,
              1.4228}},
            {"Kr",
             {17.3555, 1.9384, 6.7286, 16.5623, 5.5493, 0.2261, 3.5375, 39.3972,
              2.825}},
            {"Li",
             {1.1282, 3.9546, 0.7508, 1.0524, 0.6175, 85.3905, 0.4653, 168.261,
              0.0377}},
            {"Mg",
             {5.4204, 2.8275, 2.1735, 79.2611, 1.2269, 0.3808, 2.3073, 7.1937,
              0.8584}},
            {"Mn",
             {11.2819, 5.3409, 7.3573, 0.3432, 3.0193, 17.8674, 2.2441, 83.7543,
              1.0896}},
            {"N",
             {12.2126, 0.0057, 3.1322, 9.8933, 2.0125, 28.9975, 1.1663, 0.5826,
              -11.529}},
            {"Na",
             {4.7626, 3.285, 3.1736, 8.8422, 1.2674, 0.3136, 1.1128, 129.424,
              0.676}},
            {"Ne",
             {3.9553, 8.4042, 3.1125, 3.4262, 1.4546, 0.2306, 1.1251, 21.7184,
              0.3515}},
            {"Ni",
             {12.8376, 3.8785, 7.292, 0.2565, 4.4438, 12.1763, 2.38, 66.3421,
              1.0341}},
            {"O",
             {3.0485, 13.2771, 2.2868, 5.7011, 1.5463, 0.3239, 0.867, 32.9089,
              0.2508}},
            {"P",
             {6.4345, 1.9067, 4.1791, 27.157, 1.78, 0.526, 1.4908, 68.1645,
              1.1149}},
            {"Rb",
             {17.1784, 1.7888, 9.6435, 17.3151, 5.1399, 0.2748, 1.5292, 164.934,
              3.4873}},
            {"S",
             {6.9053, 1.4679, 5.2034, 22.2151, 1.4379, 0.2536, 1.5863, 56.172,
              0.8669}},
            {"Sc",
             {9.189, 9.0213, 7.3679, 0.5729, 1.6409, 136.108, 1.468, 51.3531,
              1.3329}},
            {"Se",
             {17.0006, 2.4098, 5.8196, 0.2726, 3.9731, 15.2372, 4.3543, 43.8163,
              2.8409}},
            {"Si",
             {6.2915, 2.4386, 3.0353, 32.3337, 1.9891, 0.6785, 1.541, 81.6937,
              1.1407}},
            {"Sr",
             {17.5663, 1.5564, 9.8184, 14.0988, 5.422, 0.1664, 2.6694, 132.376,
              2.5064}},
            {"Ti",
             {9.7595, 7.8508, 7.3558, 0.5, 1.6991, 35.6338, 1.9021, 116.105,
              1.2807}},
            {"V",
             {10.2971, 6.8657, 7.3511, 0.4385, 2.0703, 26.8938, 2.0571, 102.478,
              1.2199}},
            {"Zn",
             {14.0743, 3.2655, 7.0318, 0.2333, 5.1652, 10.3163, 2.41, 58.7097,
              1.3041}},
        };
    auto it = factors.find(symbol);
    if (it != factors.end()) {
      return it->second;
    }
    throw std::out_of_range("Atomic form factor not found for element: " +
                            symbol);
  }

private:
  AtomicFormFactors() = default;
};

/**
 * @class AtomicMasses
 * @brief Provides a static database of atomic masses (in AMU) for chemical
 * elements. Data from standard periodic tables.
 */
class AtomicMasses {
public:
  static double get(const std::string &symbol) {
    static const std::unordered_map<std::string, double> masses = {
        {"H", 1.008},   {"He", 4.0026}, {"Li", 6.94},   {"Be", 9.0122},
        {"B", 10.81},   {"C", 12.011},  {"N", 14.007},  {"O", 15.999},
        {"F", 18.998},  {"Ne", 20.180}, {"Na", 22.990}, {"Mg", 24.305},
        {"Al", 26.982}, {"Si", 28.085}, {"P", 30.974},  {"S", 32.06},
        {"Cl", 35.45},  {"Ar", 39.948}, {"K", 39.098},  {"Ca", 40.078},
        {"Sc", 44.956}, {"Ti", 47.867}, {"V", 50.942},  {"Cr", 51.996},
        {"Mn", 54.938}, {"Fe", 55.845}, {"Co", 58.933}, {"Ni", 58.693},
        {"Cu", 63.546}, {"Zn", 65.38},  {"Ga", 69.723}, {"Ge", 72.630},
        {"As", 74.922}, {"Se", 78.971}, {"Br", 79.904}, {"Kr", 83.798},
        {"Rb", 85.468}, {"Sr", 87.62},  {"Y", 88.906},  {"Zr", 91.224},
        {"Nb", 92.906}, {"Mo", 95.95},  {"Tc", 98.0},   {"Ru", 101.07},
        {"Rh", 102.91}, {"Pd", 106.42}, {"Ag", 107.87}, {"Cd", 112.41},
        {"In", 114.82}, {"Sn", 118.71}, {"Sb", 121.76}, {"Te", 127.60},
        {"I", 126.90},  {"Xe", 131.29}, {"Cs", 132.91}, {"Ba", 137.33},
        {"La", 138.91}, {"Ce", 140.12}, {"Pr", 140.91}, {"Nd", 144.24},
        {"Pm", 145.0},  {"Sm", 150.36}, {"Eu", 151.96}, {"Gd", 157.25},
        {"Tb", 158.93}, {"Dy", 162.50}, {"Ho", 164.93}, {"Er", 167.26},
        {"Tm", 168.93}, {"Yb", 173.05}, {"Lu", 174.97}, {"Hf", 178.49},
        {"Ta", 180.95}, {"W", 183.84},  {"Re", 186.21}, {"Os", 190.23},
        {"Ir", 192.22}, {"Pt", 195.08}, {"Au", 196.97}, {"Hg", 200.59},
        {"Tl", 204.38}, {"Pb", 207.2},  {"Bi", 208.98}, {"Po", 209.0},
        {"At", 210.0},  {"Rn", 222.0},  {"Fr", 223.0},  {"Ra", 226.0},
        {"Ac", 227.0},  {"Th", 232.04}, {"Pa", 231.04}, {"U", 238.03},
        {"Np", 237.0},  {"Pu", 244.0},  {"Am", 243.0},  {"Cm", 247.0},
        {"Bk", 247.0},  {"Cf", 251.0},  {"Es", 252.0},  {"Fm", 257.0},
        {"Md", 258.0},  {"No", 259.0},  {"Lr", 262.0},  {"Rf", 267.0},
        {"Db", 268.0},  {"Sg", 271.0},  {"Bh", 272.0},  {"Hs", 270.0},
        {"Mt", 276.0},  {"Ds", 281.0},  {"Rg", 280.0},  {"Cn", 285.0},
        {"Nh", 284.0},  {"Fl", 289.0},  {"Mc", 288.0},  {"Lv", 293.0},
        {"Ts", 294.0},  {"Og", 294.0}};

    auto it = masses.find(symbol);
    if (it != masses.end()) {
      return it->second;
    }
    throw std::out_of_range("Atomic mass not found for element: " + symbol);
  }

private:
  AtomicMasses() = default;
};
