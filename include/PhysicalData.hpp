// Correlation - Liquid and Amorphous Solid Analysis Tool
// Copyright © 2013-2026 Isaías Rodríguez (isurwars@gmail.com)
// SPDX-License-Identifier: MIT
// Full license: https://github.com/Isurwars/Correlation/blob/main/LICENSE

#pragma once

#include <stdexcept>
#include <string>
#include <unordered_map>
#include <vector>

/**
 * @namespace constants
 * @brief Defines universal mathematical and physical constants.
 */
namespace constants {
// Use the standard library's high-precision pi from C++20
constexpr double pi =
    3.1415926535897932384626433832795028841971693993751058209749445923078164062;
constexpr double rad2deg = 180.0 / pi;    // RADIANS -> DEGREES
constexpr double deg2rad = pi / 180.0;    // DEGREES -> RADIANS
constexpr double THz_to_cmInv = 33.35641; // THz -> cm^-1
constexpr double THz_to_meV = 4.135667;   // THz -> meV
} // namespace constants

/**
 * @class CovalentRadii
 * @brief Provides a static database of covalent radii for chemical elements.
 * Data from Pyykko, P. et al., DOI: 10.1002/chem.200800987 and Cordero, B. et
 * al., DOI: 10.1039/b801115j
 */
class CovalentRadii {
public:
  static double get(const std::string &symbol) {
    static const std::unordered_map<std::string, double> radii = {
        {"H", 0.32},  {"He", 0.46}, {"Li", 1.33}, {"Be", 1.02}, {"B", 0.85},
        {"C", 0.75},  {"N", 0.71},  {"O", 0.63},  {"F", 0.64},  {"Ne", 0.67},
        {"Na", 1.55}, {"Mg", 1.39}, {"Al", 1.26}, {"Si", 1.16}, {"P", 1.11},
        {"S", 1.03},  {"Cl", 0.99}, {"Ar", 0.96}, {"K", 1.96},  {"Ca", 1.71},
        {"Sc", 1.48}, {"Ti", 1.36}, {"V", 1.34},  {"Cr", 1.22}, {"Mn", 1.19},
        {"Fe", 1.16}, {"Co", 1.11}, {"Ni", 1.10}, {"Cu", 1.12}, {"Zn", 1.18},
        {"Ga", 1.24}, {"Ge", 1.21}, {"As", 1.21}, {"Se", 1.16}, {"Br", 1.14},
        {"Kr", 1.17}, {"Rb", 2.10}, {"Sr", 1.85}, {"Y", 1.63},  {"Zr", 1.54},
        {"Nb", 1.47}, {"Mo", 1.38}, {"Tc", 1.28}, {"Ru", 1.25}, {"Rh", 1.25},
        {"Pd", 1.20}, {"Ag", 1.28}, {"Cd", 1.36}, {"In", 1.42}, {"Sn", 1.40},
        {"Sb", 1.40}, {"Te", 1.36}, {"I", 1.33},  {"Xe", 1.31}, {"Cs", 2.32},
        {"Ba", 1.96}, {"La", 1.80}, {"Ce", 1.63}, {"Pr", 1.76}, {"Nd", 1.74},
        {"Pm", 1.73}, {"Sm", 1.72}, {"Eu", 1.68}, {"Gd", 1.69}, {"Tb", 1.68},
        {"Dy", 1.67}, {"Ho", 1.66}, {"Er", 1.65}, {"Tm", 1.64}, {"Yb", 1.70},
        {"Lu", 1.62}, {"Hf", 1.52}, {"Ta", 1.46}, {"W", 1.37},  {"Re", 1.31},
        {"Os", 1.29}, {"Ir", 1.22}, {"Pt", 1.23}, {"Au", 1.24}, {"Hg", 1.33},
        {"Tl", 1.44}, {"Pb", 1.44}, {"Bi", 1.51}, {"Po", 1.45}, {"At", 1.47},
        {"Rn", 1.42}, {"Fr", 2.23}, {"Ra", 2.01}, {"Ac", 1.86}, {"Th", 1.75},
        {"Pa", 1.69}, {"U", 1.70},  {"Np", 1.71}, {"Pu", 1.72}, {"Am", 1.66},
        {"Cm", 1.66}, {"Bk", 1.68}, {"Cf", 1.68}, {"Es", 1.65}, {"Fm", 1.67},
        {"Md", 1.73}, {"No", 1.76}, {"Lr", 1.61}, {"Rf", 1.57}, {"Db", 1.49},
        {"Sg", 1.43}, {"Bh", 1.41}, {"Hs", 1.34}, {"Mt", 1.29}, {"Ds", 1.28},
        {"Rg", 1.21}, {"Cn", 1.22}, {"Nh", 1.36}, {"Fl", 1.43}, {"Mc", 1.62},
        {"Lv", 1.75}, {"Ts", 1.65}, {"Og", 1.57}};
    auto it = radii.find(symbol);
    if (it != radii.end()) {
      return it->second;
    }
    throw std::out_of_range("Covalent radius not found for element: " + symbol);
  }

private:
  CovalentRadii() = default;
};

/**
 * @class AtomicFormFactors
 * @brief Provides a static database of atomic form factor parameters.
 * Data from International Tables for Crystallography:
 * http://it.iucr.org/CB/ch6o1v0001/
 */
class AtomicFormFactors {
public:
  static const std::vector<double> &get(const std::string &symbol) {
    static const std::unordered_map<std::string, std::vector<double>> factors =
        {
            {"H",
             {0.413048, 15.569946, 0.294953, 32.398468, 0.187491, 5.711404, 0.080701, 61.889874, 4.9e-05}},
            {"He",
             {0.732354, 11.553918, 0.753896, 4.595831, 0.283819, 1.546299, 0.190003, 26.463964, 0.000487}},
            {"Li",
             {0.974637, 4.334946, 0.158472, 0.342451, 0.811855, 97.102966, 0.262416, 201.36383, 0.002542}},
            {"Be",
             {1.533712, 42.662079, 0.638283, 0.59542, 0.601052, 99.106499, 0.106139, 0.15134, 0.002511}},
            {"B",
             {2.085185, 23.494068, 1.06458, 1.137894, 1.062788, 61.238976, 0.140515, 0.114886, 0.003823}},
            {"C",
             {2.657506, 14.780758, 1.078079, 0.776775, 1.490909, 42.086842, -4.24107, -0.000294, 4.297983}},
            {"N",
             {11.89378, 0.000158, 3.277479, 10.232723, 1.858092, 30.34469, 0.858927, 0.656065, -11.804902}},
            {"O",
             {2.960427, 14.182259, 2.508818, 5.936858, 0.637853, 0.112726, 0.722838, 34.958481, 0.027014}},
            {"F",
             {3.511943, 10.687859, 2.772244, 4.380466, 0.678385, 0.093982, 0.915159, 27.255203, 0.032557}},
            {"Ne",
             {4.183749, 8.175457, 2.905726, 3.252536, 0.520513, 0.063295, 1.135641, 21.81391, 0.025576}},
            {"Na",
             {4.910127, 3.281434, 3.081783, 9.119178, 1.262067, 0.102763, 1.098938, 132.01395, 0.079712}},
            {"Mg",
             {4.708971, 4.875207, 1.194814, 108.50608, 1.558157, 0.111516, 1.170413, 48.292408, 0.126842}},
            {"Al",
             {4.730796, 3.628931, 2.313951, 43.051167, 1.54198, 0.09596, 1.117564, 108.93239, 0.139509}},
            {"Si",
             {5.275329, 2.631338, 3.191038, 33.730728, 1.511514, 0.081119, 1.356849, 86.288643, 0.145073}},
            {"P",
             {1.950541, 0.908139, 4.14693, 27.044952, 1.49456, 0.07128, 1.522042, 67.520187, 0.155233}},
            {"S",
             {6.372157, 1.514347, 5.154568, 22.092527, 1.473732, 0.061373, 1.635073, 55.445175, 0.154722}},
            {"Cl",
             {1.446071, 0.052357, 6.870609, 1.193165, 6.151801, 18.343416, 1.750347, 46.398396, 0.146773}},
            {"Ar",
             {7.188004, 0.956221, 6.638454, 15.339877, 0.45418, 15.339862, 1.929593, 39.043823, 0.265954}},
            {"K",
             {8.163991, 12.816323, 7.146945, 0.808945, 1.07014, 210.32701, 0.877316, 39.597652, 0.253614}},
            {"Ca",
             {8.593655, 10.460644, 1.477324, 0.041891, 1.436254, 81.390381, 1.182839, 169.84784, 0.196255}},
            {"Sc",
             {1.476566, 53.131023, 1.487278, 0.035325, 1.600187, 137.31949, 9.177463, 9.098031, 0.157765}},
            {"Ti",
             {9.818524, 8.001879, 1.522646, 0.029763, 1.703101, 39.885422, 1.768774, 120.158, 0.102473}},
            {"V",
             {10.473575, 7.08194, 1.547881, 0.02604, 1.986381, 31.909672, 1.865616, 108.02284, 0.067744}},
            {"Cr",
             {11.007069, 6.366281, 1.555477, 0.023987, 2.985293, 23.244839, 1.347855, 105.7745, 0.06551}},
            {"Mn",
             {11.709542, 5.59712, 1.733414, 0.0178, 2.673141, 21.78842, 2.023368, 89.517914, -0.147293}},
            {"Fe",
             {12.311098, 5.009415, 1.876623, 0.014461, 3.066177, 18.74304, 2.070451, 82.767876, -0.304931}},
            {"Co",
             {12.91451, 4.507138, 2.481908, 0.009126, 3.466894, 16.438129, 2.106351, 76.98732, -0.936572}},
            {"Ni",
             {13.521865, 4.077277, 6.947285, 0.286763, 3.866028, 14.622634, 2.1359, 71.96608, -2.762697}},
            {"Cu",
             {14.014192, 3.73828, 4.784577, 0.003744, 5.056806, 13.034982, 1.457971, 72.554794, -3.254477}},
            {"Zn",
             {14.741002, 3.388232, 6.907748, 0.243315, 4.642337, 11.903689, 2.191766, 63.31213, -36.915829}},
            {"Ga",
             {15.758946, 3.121754, 6.841123, 0.226057, 4.121016, 12.482196, 2.714681, 66.203621, -0.847395}},
            {"Ge",
             {16.540613, 2.866618, 1.5679, 0.012198, 3.727829, 13.432163, 3.345098, 58.866047, 0.018726}},
            {"As",
             {17.025642, 2.597739, 4.503441, 0.003012, 3.715904, 14.272119, 3.9372, 50.437996, -2.984117}},
            {"Se",
             {17.354071, 2.349787, 4.653248, 0.00255, 4.259489, 15.57946, 4.136455, 45.181202, -3.160982}},
            {"Br",
             {17.55057, 2.119226, 5.411882, 16.557184, 3.93718, 0.002481, 3.880645, 42.164009, -2.492088}},
            {"Kr",
             {17.655279, 1.908231, 6.848105, 16.606236, 4.171004, 0.001598, 3.44676, 39.917473, -2.810592}},
            {"Rb",
             {8.123134, 15.142385, 2.138042, 33.542667, 6.761702, 0.129372, 1.156051, 224.13251, 1.139548}},
            {"Sr",
             {17.730219, 1.56306, 9.795867, 14.310868, 6.099763, 0.120574, 2.620025, 135.77132, 1.140251}},
            {"Y",
             {17.79204, 1.429691, 10.253252, 13.132816, 5.714949, 0.112173, 3.170516, 108.19703, 1.131787}},
            {"Zr",
             {17.859772, 1.310692, 10.911038, 12.319285, 5.821115, 0.104353, 3.512513, 91.777542, 1.124859}},
            {"Nb",
             {17.958399, 1.21159, 12.063054, 12.246687, 5.007015, 0.098615, 3.287667, 75.011948, 1.123452}},
            {"Mo",
             {6.236218, 0.09078, 17.987711, 1.10831, 12.973127, 11.46872, 3.451426, 66.684151, 1.10877}},
            {"Tc",
             {17.840963, 1.005729, 3.428236, 41.901382, 1.373012, 119.32054, 12.947364, 9.781542, 1.074784}},
            {"Ru",
             {6.271624, 0.07704, 17.906738, 0.928222, 14.123269, 9.555345, 3.746008, 35.86068, 1.043992}},
            {"Rh",
             {6.216648, 0.070789, 17.919739, 0.856121, 3.854252, 33.889484, 0.840326, 121.68669, 0.995452}},
            {"Pd",
             {6.121511, 0.062549, 4.784063, 0.784031, 16.631683, 8.751391, 4.318258, 34.489983, 0.883099}},
            {"Ag",
             {6.073874, 0.055333, 17.155437, 7.896512, 4.173344, 28.443739, 0.852238, 110.37611, 0.756603}},
            {"Cd",
             {6.080986, 0.04899, 18.019468, 7.273646, 4.018197, 29.119284, 1.30351, 95.831207, 0.603504}},
            {"In",
             {6.196477, 0.042072, 18.816183, 6.695665, 4.050479, 31.00979, 1.638929, 103.28435, 0.333097}},
            {"Sn",
             {19.325171, 6.118104, 6.281571, 0.036915, 4.498866, 32.529045, 1.856934, 95.037186, 0.119024}},
            {"Sb",
             {5.394956, 33.326523, 6.54957, 0.030974, 19.650681, 5.564929, 1.82782, 87.130966, -0.290506}},
            {"Te",
             {6.660302, 33.031654, 6.940756, 0.02575, 19.847015, 5.065547, 1.557175, 84.101616, -0.806668}},
            {"I",
             {19.884502, 4.628591, 6.736593, 0.027754, 8.110516, 31.849096, 1.170953, 84.406387, -0.448811}},
            {"Xe",
             {19.97892, 4.143356, 11.774945, 0.010142, 9.332182, 28.7962, 1.244749, 75.280685, -6.065902}},
            {"Cs",
             {17.418674, 0.399828, 8.314444, 0.016872, 10.323193, 25.605827, 1.383834, 233.33968, -2.322802}},
            {"Ba",
             {19.747343, 3.481823, 17.368477, 0.371224, 10.465718, 21.226641, 2.592602, 173.83427, -5.183497}},
            {"La",
             {19.966019, 3.197408, 27.329655, 0.003446, 11.018425, 19.955492, 3.086696, 141.38197, -21.745489}},
            {"Ce",
             {17.355122, 0.328369, 43.988499, 0.002047, 20.54665, 3.088196, 3.13067, 134.90765, -38.386017}},
            {"Pr",
             {21.551311, 2.995675, 17.16173, 0.312491, 11.903859, 17.716705, 2.679103, 152.19282, -3.871068}},
            {"Nd",
             {17.331244, 0.300269, 62.783924, 0.00132, 12.160097, 17.026001, 2.663483, 148.74899, -57.189842}},
            {"Pm",
             {17.286388, 0.28662, 51.560162, 0.00155, 12.478557, 16.223755, 2.675515, 143.98451, -45.973682}},
            {"Sm",
             {23.700363, 2.689539, 23.072214, 0.003491, 12.777782, 15.495437, 2.684217, 139.86247, -17.452166}},
            {"Eu",
             {17.186195, 0.261678, 37.156837, 0.001995, 13.103387, 14.78736, 2.707246, 134.8163, -31.586687}},
            {"Gd",
             {24.898117, 2.435028, 17.104952, 0.246961, 13.222581, 13.996325, 3.266152, 110.86309, -43.505684}},
            {"Tb",
             {25.910013, 2.373912, 32.344139, 0.002034, 13.765117, 13.481969, 2.751404, 125.83651, -26.851971}},
            {"Dy",
             {26.671785, 2.282593, 88.687576, 0.000665, 14.065445, 12.92023, 2.768497, 121.93719, -83.279831}},
            {"Ho",
             {27.15019, 2.16966, 16.999819, 0.215414, 14.059334, 12.213148, 3.386979, 100.50678, -41.165253}},
            {"Er",
             {28.174887, 2.120995, 82.493271, 0.00064, 14.624002, 11.915256, 2.802756, 114.52994, -77.135223}},
            {"Tm",
             {28.925894, 2.046203, 76.173798, 0.000656, 14.904704, 11.465375, 2.814812, 111.41198, -70.839813}},
            {"Yb",
             {29.67676, 1.97763, 65.624069, 0.00072, 15.160854, 11.044622, 2.830288, 108.13915, -60.313812}},
            {"Lu",
             {30.122866, 1.88309, 15.099346, 10.342764, 56.314899, 0.00078, 3.54098, 89.55925, -51.049416}},
            {"Hf",
             {30.617033, 1.795613, 15.145351, 9.934469, 54.933548, 0.000739, 4.096253, 76.189705, -49.719837}},
            {"Ta",
             {31.066359, 1.708732, 15.341823, 9.618455, 49.278297, 0.00076, 4.577665, 66.346199, -44.119026}},
            {"W",
             {31.5079, 1.629485, 15.682498, 9.446448, 37.960129, 0.000898, 4.885509, 59.980675, -32.864574}},
            {"Re",
             {31.888456, 1.549238, 16.117104, 9.233474, 42.390297, 0.000689, 5.211669, 54.516373, -37.412682}},
            {"Os",
             {32.210297, 1.473531, 16.67844, 9.049695, 48.559906, 0.000519, 5.455839, 50.210201, -43.677956}},
            {"Ir",
             {32.004436, 1.353767, 1.975454, 81.014175, 17.070105, 0.128093, 15.939454, 7.661196, 4.018893}},
            {"Pt",
             {31.273891, 1.316992, 18.44544, 8.797154, 17.063745, 0.124741, 5.555933, 40.177994, 4.050394}},
            {"Au",
             {16.77739, 0.122737, 19.317156, 8.62157, 32.979683, 1.256902, 5.595453, 38.00882, -6.279078}},
            {"Hg",
             {16.83989, 0.115905, 20.023823, 8.256927, 28.428564, 1.19525, 5.881564, 39.247227, 4.076478}},
            {"Tl",
             {16.630795, 0.110704, 19.386616, 7.181401, 32.808571, 1.11973, 1.747191, 90.660263, 4.066939}},
            {"Pb",
             {16.419567, 0.105499, 32.73859, 1.055049, 6.530247, 25.02589, 2.342742, 80.906593, 4.049824}},
            {"Bi",
             {16.282274, 0.10118, 32.725136, 1.002287, 6.678302, 25.714146, 2.69475, 77.057549, 4.040914}},
            {"Po",
             {16.289164, 0.098121, 32.807171, 0.966265, 21.095163, 6.046622, 2.505901, 76.598068, 4.046556}},
            {"At",
             {16.011461, 0.092639, 32.615547, 0.904416, 8.113899, 26.543257, 2.884082, 68.372963, 3.995684}},
            {"Rn",
             {16.070229, 0.090437, 32.641106, 0.876409, 21.489658, 5.239687, 2.299218, 69.188477, 4.020977}},
            {"Fr",
             {16.007385, 0.087031, 32.66383, 0.840187, 21.594351, 4.954467, 1.598497, 199.8058, 4.003472}},
            {"Ra",
             {32.56369, 0.80198, 21.396671, 4.590666, 11.298093, 22.758972, 2.834688, 160.40439, 3.981773}},
            {"Ac",
             {15.914053, 0.080511, 32.535042, 0.770669, 21.553976, 4.352206, 11.433394, 21.381622, 3.939212}},
            {"Th",
             {15.784024, 0.077067, 32.454899, 0.735137, 21.849222, 4.097976, 4.239077, 109.46411, 3.922533}},
            {"Pa",
             {32.740208, 0.709545, 21.973675, 4.050881, 12.957398, 19.231543, 3.683832, 117.255, 3.886066}},
            {"U",
             {15.679275, 0.071206, 32.824306, 0.681177, 13.660459, 18.236156, 3.687261, 112.50004, 3.854444}},
            {"Np",
             {32.999901, 0.657086, 22.638077, 3.854918, 14.219973, 17.435474, 3.67295, 109.46448, 3.769391}},
            {"Pu",
             {33.281178, 0.634999, 23.148544, 3.856168, 15.153755, 16.849735, 3.031492, 121.29204, 3.6642}},
            {"Am",
             {33.435162, 0.612785, 23.657259, 3.792942, 15.576339, 16.195778, 3.027023, 117.757, 3.54116}},
            {"Cm",
             {15.804837, 0.058619, 33.480801, 0.59016, 24.150198, 3.67472, 3.655563, 100.73619, 3.39084}},
            {"Bk",
             {15.889072, 0.055503, 33.625286, 0.569571, 24.710381, 3.615472, 3.707139, 97.694786, 3.213169}},
            {"Cf",
             {33.794075, 0.550447, 25.467693, 3.581973, 16.048487, 14.357388, 3.657525, 96.064972, 3.005326}},
        };
    auto it = factors.find(symbol);
    if (it != factors.end()) {
      return it->second;
    }
    throw std::out_of_range("Atomic form factor not found for element: " +
                            symbol);
  }

private:
  AtomicFormFactors() = default;
};

/**
 * @class AtomicMasses
 * @brief Provides a static database of atomic masses (in AMU) for chemical
 * elements. Data from standard periodic tables.
 */
class AtomicMasses {
public:
  static double get(const std::string &symbol) {
    static const std::unordered_map<std::string, double> masses = {
        {"H", 1.008},   {"He", 4.0026}, {"Li", 6.94},   {"Be", 9.0122},
        {"B", 10.81},   {"C", 12.011},  {"N", 14.007},  {"O", 15.999},
        {"F", 18.998},  {"Ne", 20.180}, {"Na", 22.990}, {"Mg", 24.305},
        {"Al", 26.982}, {"Si", 28.085}, {"P", 30.974},  {"S", 32.06},
        {"Cl", 35.45},  {"Ar", 39.948}, {"K", 39.098},  {"Ca", 40.078},
        {"Sc", 44.956}, {"Ti", 47.867}, {"V", 50.942},  {"Cr", 51.996},
        {"Mn", 54.938}, {"Fe", 55.845}, {"Co", 58.933}, {"Ni", 58.693},
        {"Cu", 63.546}, {"Zn", 65.38},  {"Ga", 69.723}, {"Ge", 72.630},
        {"As", 74.922}, {"Se", 78.971}, {"Br", 79.904}, {"Kr", 83.798},
        {"Rb", 85.468}, {"Sr", 87.62},  {"Y", 88.906},  {"Zr", 91.224},
        {"Nb", 92.906}, {"Mo", 95.95},  {"Tc", 98.0},   {"Ru", 101.07},
        {"Rh", 102.91}, {"Pd", 106.42}, {"Ag", 107.87}, {"Cd", 112.41},
        {"In", 114.82}, {"Sn", 118.71}, {"Sb", 121.76}, {"Te", 127.60},
        {"I", 126.90},  {"Xe", 131.29}, {"Cs", 132.91}, {"Ba", 137.33},
        {"La", 138.91}, {"Ce", 140.12}, {"Pr", 140.91}, {"Nd", 144.24},
        {"Pm", 145.0},  {"Sm", 150.36}, {"Eu", 151.96}, {"Gd", 157.25},
        {"Tb", 158.93}, {"Dy", 162.50}, {"Ho", 164.93}, {"Er", 167.26},
        {"Tm", 168.93}, {"Yb", 173.05}, {"Lu", 174.97}, {"Hf", 178.49},
        {"Ta", 180.95}, {"W", 183.84},  {"Re", 186.21}, {"Os", 190.23},
        {"Ir", 192.22}, {"Pt", 195.08}, {"Au", 196.97}, {"Hg", 200.59},
        {"Tl", 204.38}, {"Pb", 207.2},  {"Bi", 208.98}, {"Po", 209.0},
        {"At", 210.0},  {"Rn", 222.0},  {"Fr", 223.0},  {"Ra", 226.0},
        {"Ac", 227.0},  {"Th", 232.04}, {"Pa", 231.04}, {"U", 238.03},
        {"Np", 237.0},  {"Pu", 244.0},  {"Am", 243.0},  {"Cm", 247.0},
        {"Bk", 247.0},  {"Cf", 251.0},  {"Es", 252.0},  {"Fm", 257.0},
        {"Md", 258.0},  {"No", 259.0},  {"Lr", 262.0},  {"Rf", 267.0},
        {"Db", 268.0},  {"Sg", 271.0},  {"Bh", 272.0},  {"Hs", 270.0},
        {"Mt", 276.0},  {"Ds", 281.0},  {"Rg", 280.0},  {"Cn", 285.0},
        {"Nh", 284.0},  {"Fl", 289.0},  {"Mc", 288.0},  {"Lv", 293.0},
        {"Ts", 294.0},  {"Og", 294.0}};

    auto it = masses.find(symbol);
    if (it != masses.end()) {
      return it->second;
    }
    throw std::out_of_range("Atomic mass not found for element: " + symbol);
  }

private:
  AtomicMasses() = default;
};
